package edu.upf;

import static org.junit.Assert.assertEquals;
import static org.junit.Assert.assertNotNull;
import static org.junit.Assert.assertTrue;

import java.util.Optional;

import javax.swing.text.html.HTMLEditorKit.Parser;

import org.junit.Test;

import com.google.gson.JsonElement;

import edu.upf.parser.SimplifiedTweet;

/**
 * Unit test for simple App.
 */
public class TwitterFilterTest
{
    /**
     * Rigorous Test :-)
     */
    @Test
    public void shouldAnswerWithTrue()
    {
        assertTrue( true );
    }

    @Test
    public void parsesRealTweet()
    {
        // Here we have a Real Tweet
        String line = "{\"created_at\":\"Sat May 12 19:59:09 +0000 2018\",\"id\":995392958454292480,\"id_str\":\"995392958454292480\",\"text\":\"Proud you kept it classy @surieofficial #EUROVISION https:\\/\\/t.co\\/nzxJ5LT8Xu\",\"display_text_range\":[0,51],\"source\":\"\\u003ca href=\\\"http:\\/\\/twitter.com\\/download\\/iphone\\\" rel=\\\"nofollow\\\"\\u003eTwitter for iPhone\\u003c\\/a\\u003e\",\"truncated\":false,\"in_reply_to_status_id\":null,\"in_reply_to_status_id_str\":null,\"in_reply_to_user_id\":null,\"in_reply_to_user_id_str\":null,\"in_reply_to_screen_name\":null,\"user\":{\"id\":17044695,\"id_str\":\"17044695\",\"name\":\"Sue Atkins\",\"screen_name\":\"SueAtkins\",\"location\":\"Warlingham,Surrey\",\"url\":\"http:\\/\\/www.TheSueAtkins.com\",\"description\":\"#BBC #ITVThisMorning #SKYNews #talkRADIO #Parenting #Broadcaster #Author & #Divorce Specialist. On a mission to Make Parenting Easy http:\\/\\/www.TheSueAtkins.com\",\"translator_type\":\"none\",\"protected\":false,\"verified\":false,\"followers_count\":31016,\"friends_count\":4586,\"listed_count\":1403,\"favourites_count\":27550,\"statuses_count\":149503,\"created_at\":\"Wed Oct 29 16:26:11 +0000 2008\",\"utc_offset\":3600,\"time_zone\":\"London\",\"geo_enabled\":true,\"lang\":\"en\",\"contributors_enabled\":false,\"is_translator\":false,\"profile_background_color\":\"BADFCD\",\"profile_background_image_url\":\"http:\\/\\/pbs.twimg.com\\/profile_background_images\\/255735817\\/Screen_shot_2011-05-03_at_20.24.23.png\",\"profile_background_image_url_https\":\"https:\\/\\/pbs.twimg.com\\/profile_background_images\\/255735817\\/Screen_shot_2011-05-03_at_20.24.23.png\",\"profile_background_tile\":true,\"profile_link_color\":\"FF0000\",\"profile_sidebar_border_color\":\"F2E195\",\"profile_sidebar_fill_color\":\"FFF7CC\",\"profile_text_color\":\"0C3E53\",\"profile_use_background_image\":true,\"profile_image_url\":\"http:\\/\\/pbs.twimg.com\\/profile_images\\/994706586277949440\\/wfGmpxfL_normal.jpg\",\"profile_image_url_https\":\"https:\\/\\/pbs.twimg.com\\/profile_images\\/994706586277949440\\/wfGmpxfL_normal.jpg\",\"profile_banner_url\":\"https:\\/\\/pbs.twimg.com\\/profile_banners\\/17044695\\/1515922437\",\"default_profile\":false,\"default_profile_image\":false,\"following\":null,\"follow_request_sent\":null,\"notifications\":null},\"geo\":null,\"coordinates\":null,\"place\":null,\"contributors\":null,\"is_quote_status\":false,\"quote_count\":0,\"reply_count\":0,\"retweet_count\":0,\"favorite_count\":0,\"entities\":{\"hashtags\":[{\"text\":\"EUROVISION\",\"indices\":[40,51]}],\"urls\":[],\"user_mentions\":[{\"screen_name\":\"surieofficial\",\"name\":\"SuRie\",\"id\":46170618,\"id_str\":\"46170618\",\"indices\":[25,39]}],\"symbols\":[],\"media\":[{\"id\":995392950812184576,\"id_str\":\"995392950812184576\",\"indices\":[52,75],\"media_url\":\"http:\\/\\/pbs.twimg.com\\/tweet_video_thumb\\/DdBYnW0WkAANxx8.jpg\",\"media_url_https\":\"https:\\/\\/pbs.twimg.com\\/tweet_video_thumb\\/DdBYnW0WkAANxx8.jpg\",\"url\":\"https:\\/\\/t.co\\/nzxJ5LT8Xu\",\"display_url\":\"pic.twitter.com\\/nzxJ5LT8Xu\",\"expanded_url\":\"https:\\/\\/twitter.com\\/SueAtkins\\/status\\/995392958454292480\\/photo\\/1\",\"type\":\"photo\",\"sizes\":{\"thumb\":{\"w\":150,\"h\":150,\"resize\":\"crop\"},\"large\":{\"w\":244,\"h\":150,\"resize\":\"fit\"},\"small\":{\"w\":244,\"h\":150,\"resize\":\"fit\"},\"medium\":{\"w\":244,\"h\":150,\"resize\":\"fit\"}}}]},\"extended_entities\":{\"media\":[{\"id\":995392950812184576,\"id_str\":\"995392950812184576\",\"indices\":[52,75],\"media_url\":\"http:\\/\\/pbs.twimg.com\\/tweet_video_thumb\\/DdBYnW0WkAANxx8.jpg\",\"media_url_https\":\"https:\\/\\/pbs.twimg.com\\/tweet_video_thumb\\/DdBYnW0WkAANxx8.jpg\",\"url\":\"https:\\/\\/t.co\\/nzxJ5LT8Xu\",\"display_url\":\"pic.twitter.com\\/nzxJ5LT8Xu\",\"expanded_url\":\"https:\\/\\/twitter.com\\/SueAtkins\\/status\\/995392958454292480\\/photo\\/1\",\"type\":\"animated_gif\",\"video_info\":{\"aspect_ratio\":[122,75],\"variants\":[{\"bitrate\":0,\"content_type\":\"video\\/mp4\",\"url\":\"https:\\/\\/video.twimg.com\\/tweet_video\\/DdBYnW0WkAANxx8.mp4\"}]},\"sizes\":{\"thumb\":{\"w\":150,\"h\":150,\"resize\":\"crop\"},\"large\":{\"w\":244,\"h\":150,\"resize\":\"fit\"},\"small\":{\"w\":244,\"h\":150,\"resize\":\"fit\"},\"medium\":{\"w\":244,\"h\":150,\"resize\":\"fit\"}}}]},\"favorited\":false,\"retweeted\":false,\"possibly_sensitive\":false,\"filter_level\":\"low\",\"lang\":\"en\",\"timestamp_ms\":\"1526155149459\"}";
        Optional<SimplifiedTweet> tweet = SimplifiedTweet.fromJson(line);
        assertNotNull(tweet);
    }

    @Test
    public void parsesInvalidJSON()
    {
        // Here the '{' at the start is missing
        String line  = "\"created_at\":\"Sat May 12 19:59:09 +0000 2018\",\"id\":995392958454292480,\"id_str\":\"995392958454292480\",\"text\":\"Proud you kept it classy @surieofficial #EUROVISION https:\\/\\/t.co\\/nzxJ5LT8Xu\",\"display_text_range\":[0,51],\"source\":\"\\u003ca href=\\\"http:\\/\\/twitter.com\\/download\\/iphone\\\" rel=\\\"nofollow\\\"\\u003eTwitter for iPhone\\u003c\\/a\\u003e\",\"truncated\":false,\"in_reply_to_status_id\":null,\"in_reply_to_status_id_str\":null,\"in_reply_to_user_id\":null,\"in_reply_to_user_id_str\":null,\"in_reply_to_screen_name\":null,\"user\":{\"id\":17044695,\"id_str\":\"17044695\",\"name\":\"Sue Atkins\",\"screen_name\":\"SueAtkins\",\"location\":\"Warlingham,Surrey\",\"url\":\"http:\\/\\/www.TheSueAtkins.com\",\"description\":\"#BBC #ITVThisMorning #SKYNews #talkRADIO #Parenting #Broadcaster #Author & #Divorce Specialist. On a mission to Make Parenting Easy http:\\/\\/www.TheSueAtkins.com\",\"translator_type\":\"none\",\"protected\":false,\"verified\":false,\"followers_count\":31016,\"friends_count\":4586,\"listed_count\":1403,\"favourites_count\":27550,\"statuses_count\":149503,\"created_at\":\"Wed Oct 29 16:26:11 +0000 2008\",\"utc_offset\":3600,\"time_zone\":\"London\",\"geo_enabled\":true,\"lang\":\"en\",\"contributors_enabled\":false,\"is_translator\":false,\"profile_background_color\":\"BADFCD\",\"profile_background_image_url\":\"http:\\/\\/pbs.twimg.com\\/profile_background_images\\/255735817\\/Screen_shot_2011-05-03_at_20.24.23.png\",\"profile_background_image_url_https\":\"https:\\/\\/pbs.twimg.com\\/profile_background_images\\/255735817\\/Screen_shot_2011-05-03_at_20.24.23.png\",\"profile_background_tile\":true,\"profile_link_color\":\"FF0000\",\"profile_sidebar_border_color\":\"F2E195\",\"profile_sidebar_fill_color\":\"FFF7CC\",\"profile_text_color\":\"0C3E53\",\"profile_use_background_image\":true,\"profile_image_url\":\"http:\\/\\/pbs.twimg.com\\/profile_images\\/994706586277949440\\/wfGmpxfL_normal.jpg\",\"profile_image_url_https\":\"https:\\/\\/pbs.twimg.com\\/profile_images\\/994706586277949440\\/wfGmpxfL_normal.jpg\",\"profile_banner_url\":\"https:\\/\\/pbs.twimg.com\\/profile_banners\\/17044695\\/1515922437\",\"default_profile\":false,\"default_profile_image\":false,\"following\":null,\"follow_request_sent\":null,\"notifications\":null},\"geo\":null,\"coordinates\":null,\"place\":null,\"contributors\":null,\"is_quote_status\":false,\"quote_count\":0,\"reply_count\":0,\"retweet_count\":0,\"favorite_count\":0,\"entities\":{\"hashtags\":[{\"text\":\"EUROVISION\",\"indices\":[40,51]}],\"urls\":[],\"user_mentions\":[{\"screen_name\":\"surieofficial\",\"name\":\"SuRie\",\"id\":46170618,\"id_str\":\"46170618\",\"indices\":[25,39]}],\"symbols\":[],\"media\":[{\"id\":995392950812184576,\"id_str\":\"995392950812184576\",\"indices\":[52,75],\"media_url\":\"http:\\/\\/pbs.twimg.com\\/tweet_video_thumb\\/DdBYnW0WkAANxx8.jpg\",\"media_url_https\":\"https:\\/\\/pbs.twimg.com\\/tweet_video_thumb\\/DdBYnW0WkAANxx8.jpg\",\"url\":\"https:\\/\\/t.co\\/nzxJ5LT8Xu\",\"display_url\":\"pic.twitter.com\\/nzxJ5LT8Xu\",\"expanded_url\":\"https:\\/\\/twitter.com\\/SueAtkins\\/status\\/995392958454292480\\/photo\\/1\",\"type\":\"photo\",\"sizes\":{\"thumb\":{\"w\":150,\"h\":150,\"resize\":\"crop\"},\"large\":{\"w\":244,\"h\":150,\"resize\":\"fit\"},\"small\":{\"w\":244,\"h\":150,\"resize\":\"fit\"},\"medium\":{\"w\":244,\"h\":150,\"resize\":\"fit\"}}}]},\"extended_entities\":{\"media\":[{\"id\":995392950812184576,\"id_str\":\"995392950812184576\",\"indices\":[52,75],\"media_url\":\"http:\\/\\/pbs.twimg.com\\/tweet_video_thumb\\/DdBYnW0WkAANxx8.jpg\",\"media_url_https\":\"https:\\/\\/pbs.twimg.com\\/tweet_video_thumb\\/DdBYnW0WkAANxx8.jpg\",\"url\":\"https:\\/\\/t.co\\/nzxJ5LT8Xu\",\"display_url\":\"pic.twitter.com\\/nzxJ5LT8Xu\",\"expanded_url\":\"https:\\/\\/twitter.com\\/SueAtkins\\/status\\/995392958454292480\\/photo\\/1\",\"type\":\"animated_gif\",\"video_info\":{\"aspect_ratio\":[122,75],\"variants\":[{\"bitrate\":0,\"content_type\":\"video\\/mp4\",\"url\":\"https:\\/\\/video.twimg.com\\/tweet_video\\/DdBYnW0WkAANxx8.mp4\"}]},\"sizes\":{\"thumb\":{\"w\":150,\"h\":150,\"resize\":\"crop\"},\"large\":{\"w\":244,\"h\":150,\"resize\":\"fit\"},\"small\":{\"w\":244,\"h\":150,\"resize\":\"fit\"},\"medium\":{\"w\":244,\"h\":150,\"resize\":\"fit\"}}}]},\"favorited\":false,\"retweeted\":false,\"possibly_sensitive\":false,\"filter_level\":\"low\",\"lang\":\"en\",\"timestamp_ms\":\"1526155149459\"}";
        Optional<SimplifiedTweet> tweet = SimplifiedTweet.fromJson(line);
        assertEquals(Optional.empty(),tweet);
    }
    
    @Test
    public void parses1FieldMissing()
    {
        // Here the id field is missing
        String line = "{\"created_at\":\"Sat May 12 19:59:09 +0000 2018\",\"text\":\"Proud you kept it classy @surieofficial #EUROVISION https:\\/\\/t.co\\/nzxJ5LT8Xu\",\"display_text_range\":[0,51],\"source\":\"\\u003ca href=\\\"http:\\/\\/twitter.com\\/download\\/iphone\\\" rel=\\\"nofollow\\\"\\u003eTwitter for iPhone\\u003c\\/a\\u003e\",\"truncated\":false,\"in_reply_to_status_id\":null,\"in_reply_to_status_id_str\":null,\"in_reply_to_user_id\":null,\"in_reply_to_user_id_str\":null,\"in_reply_to_screen_name\":null,\"user\":{\"id\":17044695,\"id_str\":\"17044695\",\"name\":\"Sue Atkins\",\"screen_name\":\"SueAtkins\",\"location\":\"Warlingham,Surrey\",\"url\":\"http:\\/\\/www.TheSueAtkins.com\",\"description\":\"#BBC #ITVThisMorning #SKYNews #talkRADIO #Parenting #Broadcaster #Author & #Divorce Specialist. On a mission to Make Parenting Easy http:\\/\\/www.TheSueAtkins.com\",\"translator_type\":\"none\",\"protected\":false,\"verified\":false,\"followers_count\":31016,\"friends_count\":4586,\"listed_count\":1403,\"favourites_count\":27550,\"statuses_count\":149503,\"created_at\":\"Wed Oct 29 16:26:11 +0000 2008\",\"utc_offset\":3600,\"time_zone\":\"London\",\"geo_enabled\":true,\"lang\":\"en\",\"contributors_enabled\":false,\"is_translator\":false,\"profile_background_color\":\"BADFCD\",\"profile_background_image_url\":\"http:\\/\\/pbs.twimg.com\\/profile_background_images\\/255735817\\/Screen_shot_2011-05-03_at_20.24.23.png\",\"profile_background_image_url_https\":\"https:\\/\\/pbs.twimg.com\\/profile_background_images\\/255735817\\/Screen_shot_2011-05-03_at_20.24.23.png\",\"profile_background_tile\":true,\"profile_link_color\":\"FF0000\",\"profile_sidebar_border_color\":\"F2E195\",\"profile_sidebar_fill_color\":\"FFF7CC\",\"profile_text_color\":\"0C3E53\",\"profile_use_background_image\":true,\"profile_image_url\":\"http:\\/\\/pbs.twimg.com\\/profile_images\\/994706586277949440\\/wfGmpxfL_normal.jpg\",\"profile_image_url_https\":\"https:\\/\\/pbs.twimg.com\\/profile_images\\/994706586277949440\\/wfGmpxfL_normal.jpg\",\"profile_banner_url\":\"https:\\/\\/pbs.twimg.com\\/profile_banners\\/17044695\\/1515922437\",\"default_profile\":false,\"default_profile_image\":false,\"following\":null,\"follow_request_sent\":null,\"notifications\":null},\"geo\":null,\"coordinates\":null,\"place\":null,\"contributors\":null,\"is_quote_status\":false,\"quote_count\":0,\"reply_count\":0,\"retweet_count\":0,\"favorite_count\":0,\"entities\":{\"hashtags\":[{\"text\":\"EUROVISION\",\"indices\":[40,51]}],\"urls\":[],\"user_mentions\":[{\"screen_name\":\"surieofficial\",\"name\":\"SuRie\",\"id\":46170618,\"id_str\":\"46170618\",\"indices\":[25,39]}],\"symbols\":[],\"media\":[{\"id\":995392950812184576,\"id_str\":\"995392950812184576\",\"indices\":[52,75],\"media_url\":\"http:\\/\\/pbs.twimg.com\\/tweet_video_thumb\\/DdBYnW0WkAANxx8.jpg\",\"media_url_https\":\"https:\\/\\/pbs.twimg.com\\/tweet_video_thumb\\/DdBYnW0WkAANxx8.jpg\",\"url\":\"https:\\/\\/t.co\\/nzxJ5LT8Xu\",\"display_url\":\"pic.twitter.com\\/nzxJ5LT8Xu\",\"expanded_url\":\"https:\\/\\/twitter.com\\/SueAtkins\\/status\\/995392958454292480\\/photo\\/1\",\"type\":\"photo\",\"sizes\":{\"thumb\":{\"w\":150,\"h\":150,\"resize\":\"crop\"},\"large\":{\"w\":244,\"h\":150,\"resize\":\"fit\"},\"small\":{\"w\":244,\"h\":150,\"resize\":\"fit\"},\"medium\":{\"w\":244,\"h\":150,\"resize\":\"fit\"}}}]},\"extended_entities\":{\"media\":[{\"id\":995392950812184576,\"id_str\":\"995392950812184576\",\"indices\":[52,75],\"media_url\":\"http:\\/\\/pbs.twimg.com\\/tweet_video_thumb\\/DdBYnW0WkAANxx8.jpg\",\"media_url_https\":\"https:\\/\\/pbs.twimg.com\\/tweet_video_thumb\\/DdBYnW0WkAANxx8.jpg\",\"url\":\"https:\\/\\/t.co\\/nzxJ5LT8Xu\",\"display_url\":\"pic.twitter.com\\/nzxJ5LT8Xu\",\"expanded_url\":\"https:\\/\\/twitter.com\\/SueAtkins\\/status\\/995392958454292480\\/photo\\/1\",\"type\":\"animated_gif\",\"video_info\":{\"aspect_ratio\":[122,75],\"variants\":[{\"bitrate\":0,\"content_type\":\"video\\/mp4\",\"url\":\"https:\\/\\/video.twimg.com\\/tweet_video\\/DdBYnW0WkAANxx8.mp4\"}]},\"sizes\":{\"thumb\":{\"w\":150,\"h\":150,\"resize\":\"crop\"},\"large\":{\"w\":244,\"h\":150,\"resize\":\"fit\"},\"small\":{\"w\":244,\"h\":150,\"resize\":\"fit\"},\"medium\":{\"w\":244,\"h\":150,\"resize\":\"fit\"}}}]},\"favorited\":false,\"retweeted\":false,\"possibly_sensitive\":false,\"filter_level\":\"low\",\"lang\":\"en\",\"timestamp_ms\":\"1526155149459\"}";
        Optional<SimplifiedTweet> tweet = SimplifiedTweet.fromJson(line);
        assertEquals(Optional.empty(),tweet);
    }

}
